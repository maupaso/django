{% load static %}


<!DOCTYPE html>
<html Lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <link rel="icon" href="{%static 'carioquinha/images/favicon.ico' %}">
  <!--<link rel="icon" href="../../../images/favicon.ico">-->
  <style type="text/css">
    .div.half {
        width: 50%;
    }
    .div.full {
      width: 100%;
    }
  </style>


  <title>Carioquinhas</title>

 <link href="{% static 'carioquinha/bootstrap/css/bootstrap.css' %}" rel="stylesheet">
</head>

<body onLoad="getLocation()">


<div>

  <nav class="navbar navbar-dark bg-dark">
  <!-- Navbar content -->
  <a class="navbar-brand" href="#">
    <img max height="60 px" src="../static/carioquinha/images/LOGO-CARIOQUINHAS-WHITE.png"/></a>
</nav>

<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <!--<a class="navbar-brand" href="#">Home</a>-->
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Quem somos</a>
      </li>
      <!--<li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Dropdown
        </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="#">Action</a>
          <a class="dropdown-item" href="#">Another action</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="#">Something else here</a>
        </div>
      </li>-->
      <li class="nav-item">
        <a class="nav-link disabled" href="#">Disabled</a>
      </li>
    </ul>
    <form class="form-inline my-2 my-lg-0">
      <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
      <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
    </form>
  </div>
</nav>
</div>

<div>
  <div class="half" style="float: left; text-align: left;padding: 10vw; ">
    
    <!--Clima: <input type="checkbox" id="myCheck" onclick="myFunction()">-->
    Clima: <input type="checkbox" id="buttonClima" onclick="myFunction()">
      
  </div>

  <div class="half" style="float: right; text-align: left;padding: 10vw; border: 1px">


<script type="text/javascript">
      function myFunction() {
        // Get the checkbox
        var checkBox = document.getElementById("buttonClima");
        // Get the output text
        var text = document.getElementById("text");

        // If the checkbox is checked, display the output text
        if (checkBox.checked == true){
          text.style.display = "block";
        } else {
          text.style.display = "none";
        }
      }
</script>

    <div class="weather" id="text" style="display: none" align="left">
      <div class="day">
          <p class="icon">["text_icon"]["icon"]["day"]</p>
          <p class="text">["text_icon"]["text"]["phrase"]["reduced"]</p>
          <p class="temperature">["temperature"]["max"] / ["temperature"]["min"]</p>
      </div>

      <div class="morning">
          <p class="icon">["text_icon"]["icon"]["morning"]</p>
          <p class="text">["text_icon"]["text"]["phrase"]["morning"]</p>
          <p class="temperature">["temperature"]["morning"]["max"] / ["temperature"]["min"]</p>
      </div>

      <div class="afternoon">
          <p class="icon">["text_icon"]["icon"]["afternoon"]</p>
          <p class="text">["text_icon"]["text"]["phrase"]["afternoon"]</p>
          <p class="temperature">["temperature"]["morning"]["max"] / ["afternoon"]["min"]</p>
      </div>

      <div class="night">
          <p class="icon">["text_icon"]["icon"]["night"]</p>
          <p class="text">["text_icon"]["text"]["phrase"]["night"]</p>
          <p class="temperature">["temperature"]["night"]["max"] / ["temperature"]["min"]</p>
      </div>
    </div>

    <div class="span">
      put more things here
    </div>
  </div>
</div>
<br/>
<br/>
<br/>
<div class="full">

    <script src="{% static 'carioquinha/js/jquery.js' %}"></script>
    <script src="{% static 'carioquinha/bootstrap/js/bootstrap.js' %}"></script>
    <script type="text/javascript">
      
        var x = document.getElementById("demo");

        var city = "";
        var state = "";
        var country = "";
        var id = "";


        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, showError);
            } else { 
                x.innerHTML = "Geolocation is not supported by this browser.";
            }
        }

        function showPosition(position) {
            //getGoogleLocationInfo(position.coords.latitude, position.coords.longitude);
            getWeather(3477);
        }

        function showError(error) {
            switch(error.code) {
                case error.PERMISSION_DENIED:
                    x.innerHTML = "User denied the request for Geolocation."
                    break;
                case error.POSITION_UNAVAILABLE:
                    x.innerHTML = "Location information is unavailable."
                    break;
                case error.TIMEOUT:
                    x.innerHTML = "The request to get user location timed out."
                    break;
                case error.UNKNOWN_ERROR:
                    x.innerHTML = "An unknown error occurred."
                    break;
            }
        }


        function getGoogleLocationInfo(lat, lng) {
          var xhttp = new XMLHttpRequest();
          xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {

                city = "";
                state = "";
                country = "";

                var json = JSON.parse(this.responseText);
                var resultLength = json["results"].length;

                for(var i = 0; i < resultLength; i++){
                    var addressComponentLength = json["results"][i]["address_components"].length;

                    for(var j = 0; j < addressComponentLength; j++){
                        var typesLength = json["results"][i]["address_components"][j]["types"].length;

                        for (var x = 0; x < typesLength; x++){
                            if(json["results"][i]["address_components"][j]["types"][x] == "locality" && city == ""){
                                city = json["results"][i]["address_components"][j]["short_name"];
                            }
                            if(json["results"][i]["address_components"][j]["types"][x] == "administrative_area_level_1" && state == ""){
                                state = json["results"][i]["address_components"][j]["short_name"];
                            }
                            if(json["results"][i]["address_components"][j]["types"][x] == "country" && country == ""){
                                country = json["results"][i]["address_components"][j]["short_name"];
                            }
                        }
                    }
                }             

                getPlaceId(city, state);
            }
          };


          var prefix = "https://maps.googleapis.com/maps/api/geocode/json?latlng=";
          var sufix  = "&key=AIzaSyCAN8HtOi-Om0uHY5QYRz1T73yOw8TrOAk";

          xhttp.open("GET", (prefix + "" + lat + "," + lng + "" + sufix), true);
          xhttp.send();
        }


        function getPlaceId(city, state){
          var xhttp = new XMLHttpRequest();
          xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {

                var json = JSON.parse(this.responseText);

                id = json[0]["id"];

                console.log(id);

                getWeather(id);
            }
          };


          var prefix = "http://apiadvisor.climatempo.com.br/api/v1/locale/city?name=";
          var sufix  = "&token=69ea8f47c3656a72c8cfa63cefe3ebb1";

          var url = prefix + "" + city + "&state=" + state + "" + sufix;

          xhttp.open("GET", url, true);
          //xhttp.withCredentials = true;
          //xhttp.setRequestHeader("Content-Type", "text/plain;charset=UTF-8");
          //xhttp.setRequestHeader("Access-Control-Allow-Origin", "oi");
          //xhttp.open("GET", "https://cors-escape.herokuapp.com/"+url);
          //xhttp.setRequestHeader("Accept", 'application/json');
          xhttp.send();
        }

        function getWeather(id){
          var xhttp = new XMLHttpRequest();
          //xhttp.onreadystatechange = function() {
            //if (this.readyState == 4 && this.status == 200) {

                this.responseText = '{"id":3477,"name":"S\u00e3o Paulo","state":"SP","country":"BR  ","data":[{"date":"2018-11-03","date_br":"03/11/2018","humidity":{"min":46,"max":94,"dawn":{"min":91,"max":94},"morning":{"min":54,"max":83},"afternoon":{"min":46,"max":51},"night":{"min":56,"max":91}},"rain":{"probability":80,"precipitation":15},"wind":{"velocity_min":9,"velocity_max":26,"velocity_avg":19,"gust_max":36,"direction_degrees":357,"direction":"NNW","dawn":{"direction":"E","gust_max":36,"velocity_max":19},"morning":{"direction":"NNE","gust_max":34,"velocity_max":20},"afternoon":{"direction":"NW","gust_max":34,"velocity_max":26},"night":{"direction":"WNW","gust_max":29,"velocity_max":22}},"uv":{"max":10},"thermal_sensation":{"min":18,"max":34},"text_icon":{"icon":{"dawn":"2rn","morning":"2r","afternoon":"4t","night":"4tn","day":"4t"},"text":{"pt":"Sol, pancadas de chuva e trovoadas.","en":null,"es":null,"phrase":{"reduced":"Sol com muitas nuvens. Pancadas de chuva \u00e0 tarde e \u00e0 noite.","morning":"Sol com muitas nuvens","afternoon":"Sol, pancadas de chuva e trovoadas.","night":"Muitas nuvens, chuva e raios","dawn":"Muitas nuvens"}}},"temperature":{"min":18,"max":31,"dawn":{"min":18,"max":19},"morning":{"min":18,"max":25},"afternoon":{"min":27,"max":31},"night":{"min":27,"max":31}}},{"date":"2018-11-04","date_br":"04/11/2018","humidity":{"min":67,"max":96,"dawn":{"min":null,"max":96},"morning":{"min":76,"max":90},"afternoon":{"min":90,"max":92},"night":{"min":93,"max":94}},"rain":{"probability":75,"precipitation":8},"wind":{"velocity_min":3,"velocity_max":25,"velocity_avg":18,"gust_max":43,"direction_degrees":152,"direction":"SE","dawn":{"direction":"ESE","gust_max":30,"velocity_max":20},"morning":{"direction":"SSE","gust_max":27,"velocity_max":20},"afternoon":{"direction":"SSE","gust_max":33,"velocity_max":24},"night":{"direction":"SE","gust_max":43,"velocity_max":25}},"uv":{"max":11},"thermal_sensation":{"min":17,"max":24},"text_icon":{"icon":{"dawn":"4rn","morning":"4r","afternoon":"4r","night":"4rn","day":"4r"},"text":{"pt":"Sol com muitas nuvens e chuva","en":"Sun and rain.","es":"Sol con muchas nubes durante el d\u00eda. Per\u00edodos de nublado, con lluvia a cualquier hora.","phrase":{"reduced":"Sol com muitas nuvens durante o dia. Per\u00edodos de nublado, com chuva a qualquer hora.","morning":"Sol com muitas nuvens e chuva","afternoon":"Sol com muitas nuvens e chuva","night":"Muitas nuvens e chuva","dawn":"Muitas nuvens e chuva"}}},"temperature":{"min":17,"max":24,"dawn":{"min":19,"max":24},"morning":{"min":19,"max":20},"afternoon":{"min":18,"max":19},"night":{"min":17,"max":18}}},{"date":"2018-11-05","date_br":"05/11/2018","humidity":{"min":85,"max":94,"dawn":{"min":93,"max":94},"morning":{"min":86,"max":94},"afternoon":{"min":85,"max":86},"night":{"min":88,"max":92}},"rain":{"probability":40,"precipitation":2},"wind":{"velocity_min":19,"velocity_max":25,"velocity_avg":23,"gust_max":42,"direction_degrees":126,"direction":"ESE","dawn":{"direction":"ESE","gust_max":42,"velocity_max":24},"morning":{"direction":"ESE","gust_max":40,"velocity_max":24},"afternoon":{"direction":"ESE","gust_max":35,"velocity_max":25},"night":{"direction":"ESE","gust_max":38,"velocity_max":25}},"uv":{"max":11},"thermal_sensation":{"min":16,"max":23},"text_icon":{"icon":{"dawn":"3n","morning":"3","afternoon":"2r","night":"3n","day":"3"},"text":{"pt":"Nublado","en":"Cloudy.","es":"Cielo nublado de d\u00eda y de noche. Posibilidad de llovizna.","phrase":{"reduced":"Nublado com aberturas de sol \u00e0\u00a0 tarde. Pode garoar de manh\u00e3 e \u00e0 noite.","morning":"Nublado","afternoon":"Sol com muitas nuvens","night":"Nublado com possibilidade de chuviscos","dawn":"Nublado com possibilidade de chuviscos"}}},"temperature":{"min":16,"max":23,"dawn":{"min":18,"max":21},"morning":{"min":16,"max":17},"afternoon":{"min":18,"max":23},"night":{"min":16,"max":20}}},{"date":"2018-11-06","date_br":"06/11/2018","humidity":{"min":71,"max":94,"dawn":{"min":94,"max":94},"morning":{"min":74,"max":93},"afternoon":{"min":71,"max":80},"night":{"min":84,"max":90}},"rain":{"probability":0,"precipitation":0},"wind":{"velocity_min":16,"velocity_max":24,"velocity_avg":20,"gust_max":42,"direction_degrees":118,"direction":"ESE","dawn":{"direction":"ESE","gust_max":42,"velocity_max":23},"morning":{"direction":"E","gust_max":36,"velocity_max":20},"afternoon":{"direction":"E","gust_max":23,"velocity_max":21},"night":{"direction":"SE","gust_max":31,"velocity_max":24}},"uv":{"max":11},"thermal_sensation":{"min":16,"max":29},"text_icon":{"icon":{"dawn":"2rn","morning":"2r","afternoon":"2","night":"2n","day":"2"},"text":{"pt":"Sol com algumas nuvens","en":"Mostly sunny.","es":"Sol con algunas nubes. No llueve.","phrase":{"reduced":"Dia de sol com algumas nuvens e n\u00e9voa ao amanhecer. Noite com poucas nuvens.","morning":"Sol com muitas nuvens","afternoon":"Sol com algumas nuvens","night":"Algumas nuvens","dawn":"Muitas nuvens"}}},"temperature":{"min":16,"max":27,"dawn":{"min":17,"max":18},"morning":{"min":16,"max":20},"afternoon":{"min":22,"max":27},"night":{"min":19,"max":24}}},{"date":"2018-11-07","date_br":"07/11/2018","humidity":{"min":81,"max":94,"dawn":{"min":91,"max":92},"morning":{"min":83,"max":93},"afternoon":{"min":81,"max":93},"night":{"min":93,"max":94}},"rain":{"probability":80,"precipitation":20},"wind":{"velocity_min":13,"velocity_max":23,"velocity_avg":19,"gust_max":39,"direction_degrees":122,"direction":"ESE","dawn":{"direction":"ESE","gust_max":33,"velocity_max":21},"morning":{"direction":"E","gust_max":28,"velocity_max":18},"afternoon":{"direction":"SE","gust_max":30,"velocity_max":23},"night":{"direction":"ESE","gust_max":39,"velocity_max":23}},"uv":{"max":9},"thermal_sensation":{"min":18,"max":25},"text_icon":{"icon":{"dawn":"2rn","morning":"2r","afternoon":"4r","night":"4rn","day":"4r"},"text":{"pt":"Sol com muitas nuvens e chuva","en":"Sun and rain.","es":"Sol con muchas nubes durante el d\u00eda. Per\u00edodos de nublado, con lluvia a cualquier hora.","phrase":{"reduced":"Sol com muitas nuvens. Pancadas de chuva \u00e0 tarde e \u00e0 noite.","morning":"Sol com muitas nuvens","afternoon":"Sol com muitas nuvens e chuva","night":"Muitas nuvens e chuva","dawn":"Muitas nuvens"}}},"temperature":{"min":18,"max":25,"dawn":{"min":18,"max":19},"morning":{"min":19,"max":21},"afternoon":{"min":22,"max":25},"night":{"min":19,"max":22}}},{"date":"2018-11-08","date_br":"08/11/2018","humidity":{"min":66,"max":94,"dawn":{"min":93,"max":94},"morning":{"min":69,"max":94},"afternoon":{"min":66,"max":76},"night":{"min":79,"max":93}},"rain":{"probability":60,"precipitation":4},"wind":{"velocity_min":17,"velocity_max":28,"velocity_avg":23,"gust_max":41,"direction_degrees":114,"direction":"ESE","dawn":{"direction":"ESE","gust_max":41,"velocity_max":23},"morning":{"direction":"E","gust_max":36,"velocity_max":23},"afternoon":{"direction":"E","gust_max":30,"velocity_max":26},"night":{"direction":"ESE","gust_max":41,"velocity_max":28}},"uv":{"max":9},"thermal_sensation":{"min":16,"max":20},"text_icon":{"icon":{"dawn":"2n","morning":"2","afternoon":"4","night":"4n","day":"4"},"text":{"pt":"Sol e Chuva","en":"Sun and rain.","es":"Sol y aumento de nubes. Chubascos aislados en la tarde y en la noche.","phrase":{"reduced":"Sol e aumento de nuvens de manh\u00e3. Pancadas de chuva \u00e0 tarde e \u00e0 noite.","morning":"Sol com algumas nuvens","afternoon":"Sol e Chuva","night":"Algumas nuvens e chuva","dawn":"Algumas nuvens"}}},"temperature":{"min":16,"max":20,"dawn":{"min":16,"max":17},"morning":{"min":16,"max":17},"afternoon":{"min":17,"max":20},"night":{"min":18,"max":20}}},{"date":"2018-11-09","date_br":"09/11/2018","humidity":{"min":54,"max":93,"dawn":{"min":89,"max":92},"morning":{"min":60,"max":91},"afternoon":{"min":54,"max":57},"night":{"min":63,"max":89}},"rain":{"probability":0,"precipitation":0},"wind":{"velocity_min":20,"velocity_max":26,"velocity_avg":22,"gust_max":46,"direction_degrees":104,"direction":"E","dawn":{"direction":"E","gust_max":46,"velocity_max":24},"morning":{"direction":"E","gust_max":41,"velocity_max":26},"afternoon":{"direction":"E","gust_max":29,"velocity_max":24},"night":{"direction":"ESE","gust_max":36,"velocity_max":23}},"uv":{"max":0},"thermal_sensation":{"min":15,"max":21},"text_icon":{"icon":{"dawn":"2n","morning":"2","afternoon":"2","night":"2n","day":"2"},"text":{"pt":"Sol com algumas nuvens","en":"Mostly sunny.","es":"Sol con algunas nubes. No llueve.","phrase":{"reduced":"Sol com algumas nuvens. N\u00e3o chove.","morning":"Sol com algumas nuvens","afternoon":"Sol com algumas nuvens","night":"Algumas nuvens","dawn":"Algumas nuvens"}}},"temperature":{"min":15,"max":21,"dawn":{"min":16,"max":17},"morning":{"min":15,"max":18},"afternoon":{"min":19,"max":21},"night":{"min":17,"max":21}}}]}'


                var json = JSON.parse(this.responseText);

                var dataLength = json["data"].length;

                for(var i = 0; i < 1/*dataLength*/; i++){
                    var data = json["data"][i]
                    var date = data.date_br;

                    var humidity = json["data"][i]["humidity"];
                    var rain = json["data"][i]["rain"];
                    var wind = json["data"][i]["wind"];
                    var uv = json["data"][i]["uv"];
                    var thermalSensation = json["data"][i]["thermal_sensation"];
                    var textIcon = json["data"][i]["text_icon"];
                    var temperature = json["data"][i]["temperature"];

                    $(".day > .icon").html(textIcon["icon"]["day"]);
                    $(".day > .text").html(textIcon["text"]["phrase"]["reduced"]);
                    $(".day > .temperature").html(temperature["max"] + "/" + temperature["min"]);

                    $(".morning > .icon").html(textIcon["icon"]["day"]);
                    $(".morning > .text").html(textIcon["text"]["phrase"]["reduced"]);
                    $(".morning > .temperature").html(temperature["morning"]["max"] + "/" + temperature["morning"]["min"]);

                    $(".afternoon > .icon").html(textIcon["icon"]["day"]);
                    $(".afternoon > .text").html(textIcon["text"]["phrase"]["reduced"]);
                    $(".afternoon > .temperature").html(temperature["afternoon"]["max"] + "/" + temperature["afternoon"]["min"]);

                    $(".night > .icon").html(textIcon["icon"]["day"]);
                    $(".night > .text").html(textIcon["text"]["phrase"]["reduced"]);
                    $(".night > .temperature").html(temperature["night"]["max"] + "/" + temperature["night"]["min"]);



                }     
            //}
          //};

          var prefix = "http://apiadvisor.climatempo.com.br/api/v1/weather/locale/";
          var sufix  = "/days/15?token=69ea8f47c3656a72c8cfa63cefe3ebb1";

          var url = prefix + "" + id + "" + sufix

          //xhttp.open("GET", url, true);
          //xhttp.setRequestHeader("Access-Control-Allow-Origin", "oi");
          //xhttp.send();
        }


    </script>
</div>
</body>
</html>